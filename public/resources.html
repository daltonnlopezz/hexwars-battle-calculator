<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HEX Wars Resource Calculator</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Logo -->
    <div class="logo-container">
        <img src="static/images/logo.jpg" alt="HEX Wars Logo" class="logo-image" />
    </div>

    <h1>HEX WARS RESOURCE CALCULATOR</h1>

    <!-- Navigation Card -->
    <div class="nav-card">
        <a href="index.html" class="factions-btn">
            <span class="btn-icon">‚öîÔ∏è</span>
            <span class="btn-text">Battle Calculator</span>
        </a>
        <a href="factions.html" class="character-btn">
            <span class="btn-icon">üìã</span>
            <span class="btn-text">View Faction Details</span>
        </a>
    </div>

    <!-- Resource Pool Section -->
    <div class="resource-pool-section">
        <div class="army-card">
            <div class="card-header attacker-header">
                <span class="header-icon">üí∞</span>
                <h2>Resource Pool</h2>
            </div>
            <div class="card-content">
                <div class="resource-pool-grid">
                    <div class="resource-pool-item">
                        <span class="resource-icon">üçñ</span>
                        <label for="poolFood">Food:</label>
                        <input type="number" id="poolFood" min="0" value="0" placeholder="0">
                    </div>
                    <div class="resource-pool-item">
                        <span class="resource-icon">üí∞</span>
                        <label for="poolGold">Gold:</label>
                        <input type="number" id="poolGold" min="0" value="0" placeholder="0">
                    </div>
                    <div class="resource-pool-item">
                        <span class="resource-icon">‚öíÔ∏è</span>
                        <label for="poolIron">Iron:</label>
                        <input type="number" id="poolIron" min="0" value="0" placeholder="0">
                    </div>
                    <div class="resource-pool-item">
                        <span class="resource-icon">üì¶</span>
                        <label for="poolOther">Other:</label>
                        <input type="number" id="poolOther" min="0" value="0" placeholder="0">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Resource Calculator Container -->
    <div class="calculator-container">
        
        <!-- Terrain Section -->
        <div class="army-card attacker-card">
            <div class="card-header attacker-header">
                <span class="header-icon">üå≤</span>
                <h2>Terrain Holdings</h2>
            </div>
            <div class="card-content">
                <div class="units-section">
                    <h3>Terrain Types</h3>
                    <div class="units-grid">
                        <div class="unit-row">
                            <label for="plains">Plains:</label>
                            <input type="number" id="plains" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="forest">Forest:</label>
                            <input type="number" id="forest" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="hills">Hills:</label>
                            <input type="number" id="hills" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="sea">Sea:</label>
                            <input type="number" id="sea" min="0" value="0" placeholder="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Building Section -->
        <div class="army-card defender-card">
            <div class="card-header defender-header">
                <span class="header-icon">üè∞</span>
                <h2>Building Holdings</h2>
            </div>
            <div class="card-content">
                <div class="units-section">
                    <h3>Building Types</h3>
                    <div class="units-grid">
                        <div class="unit-row">
                            <label for="castle">Castle:</label>
                            <input type="number" id="castle" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="outpost">Outpost:</label>
                            <input type="number" id="outpost" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="harbor">Harbor:</label>
                            <input type="number" id="harbor" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="bloodshrine">Bloodshrine:</label>
                            <input type="number" id="bloodshrine" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="mine">Mine:</label>
                            <input type="number" id="mine" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="fishery">Fishery:</label>
                            <input type="number" id="fishery" min="0" value="0" placeholder="0">
                        </div>
                        <div class="unit-row">
                            <label for="breeding_den">Breeding Den:</label>
                            <input type="number" id="breeding_den" min="0" value="0" placeholder="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
        <button class="clear-btn" onclick="clearAllInputs()">
            <span class="btn-icon">üóëÔ∏è</span>
            Clear All
        </button>
        <button class="calculate-btn" onclick="calculateResources()">
            <span class="btn-icon">üí∞</span>
            Calculate Resources
        </button>
        <button class="calculate-btn" onclick="sendToResourcePool()">
            <span class="btn-icon">üì•</span>
            Send to Resource Pool
        </button>
    </div>

    <!-- Results Section -->
    <div id="results" class="results-section" style="display: none;">
        <div class="results-wrapper">
            <div class="results-card">
                <div class="battle-results">
                    <h2>Resource Income Results</h2>
                    <div id="resourceResults"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Unit Recruitment Section -->
    <div class="recruitment-section">
        <div class="army-card">
            <div class="card-header supporters-header">
                <span class="header-icon">‚öîÔ∏è</span>
                <h2>Unit Recruitment</h2>
            </div>
            <div class="card-content">
                <div class="faction-selector">
                    <label for="recruitmentFaction">Faction:</label>
                    <select id="recruitmentFaction" onchange="updateRecruitmentUnits()">
                        <option value="Empire">Empire</option>
                        <option value="Raiders">Raiders</option>
                        <option value="HORDE">HORDE</option>
                        <option value="Ironborne">Ironborne</option>
                        <option value="Vanguard">Vanguard</option>
                        <option value="Damned">Damned</option>
                    </select>
                </div>
                <div class="units-section">
                    <h3>Available Units</h3>
                    <div id="recruitmentUnits" class="recruitment-grid"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Unit data for each faction
        const factionUnits = {
            Empire: [
                { name: "Ranger", food: 5, gold: 3, iron: 2, other: 0 },
                { name: "Sentinel", food: 5, gold: 5, iron: 2, other: 0 },
                { name: "Siege Tower", food: 2, gold: 7, iron: 7, other: 0 },
                { name: "Corvette", food: 15, gold: 5, iron: 5, other: 0 },
                { name: "Galley", food: 10, gold: 3, iron: 3, other: 0 },
                { name: "Legionnaire", food: 5, gold: 50, iron: 2, other: 0 },
                { name: "Imperial Guard", food: 5, gold: 50, iron: 2, other: 0 }
            ],
            Raiders: [
                { name: "Raider", food: 5, gold: 2, iron: 2, other: 0 },
                { name: "Marauder", food: 5, gold: 4, iron: 3, other: 0 },
                { name: "Ballista", food: 2, gold: 4, iron: 4, other: 0 },
                { name: "Marauder", food: 15, gold: 4, iron: 4, other: 0 },
                { name: "Bireme", food: 10, gold: 3, iron: 3, other: 0 },
                { name: "Lord of the Swamp", food: 5, gold: 50, iron: 2, other: 0 },
                { name: "Lord of the Tides", food: 5, gold: 50, iron: 4, other: 0 }
            ],
            HORDE: [
                { name: "Bearzerker", food: 8, gold: 2, iron: 2, other: 0 },
                { name: "Yotes", food: 5, gold: 1, iron: 1, other: 0 },
                { name: "Battering Ram", food: 2, gold: 4, iron: 8, other: 0 },
                { name: "Warship", food: 15, gold: 5, iron: 5, other: 0 },
                { name: "Karve", food: 10, gold: 3, iron: 3, other: 0 },
                { name: "Shaiyan Battle Born", food: 8, gold: 50, iron: 2, other: 0 },
                { name: "Throgg Stone Face", food: 8, gold: 50, iron: 2, other: 0 }
            ],
            Ironborne: [
                { name: "Guardian", food: 8, gold: 2, iron: 4, other: 0 },
                { name: "Crossbow", food: 8, gold: 3, iron: 2, other: 0 },
                { name: "Trebuchet", food: 2, gold: 8, iron: 15, other: 0 },
                { name: "Ironclad", food: 15, gold: 6, iron: 6, other: 0 },
                { name: "Cruiser", food: 10, gold: 3, iron: 3, other: 0 },
                { name: "Death Knight", food: 8, gold: 50, iron: 4, other: 0 },
                { name: "Silverbolt", food: 8, gold: 50, iron: 2, other: 0 }
            ],
            Vanguard: [
                { name: "Swordsman", food: 5, gold: 2, iron: 3, other: 0 },
                { name: "Knight", food: 10, gold: 4, iron: 4, other: 0 },
                { name: "Catapult", food: 2, gold: 5, iron: 10, other: 0 },
                { name: "Destroyer", food: 15, gold: 7, iron: 7, other: 0 },
                { name: "Frigate", food: 10, gold: 3, iron: 3, other: 0 },
                { name: "Duke", food: 5, gold: 50, iron: 3, other: 0 },
                { name: "Archer", food: 5, gold: 50, iron: 3, other: 0 }
            ],
            Damned: [
                { name: "Thrall", food: 0, gold: 0, iron: 0, other: 0 },
                { name: "Lost Soul", food: 0, gold: 0, iron: 0, other: 0 },
                { name: "Harvester", food: 0, gold: 0, iron: 0, other: 5 },
                { name: "Plaguebringer", food: 0, gold: 0, iron: 0, other: 25 }
            ]
        };

        function updateRecruitmentUnits() {
            const faction = document.getElementById('recruitmentFaction').value;
            const units = factionUnits[faction] || [];
            const container = document.getElementById('recruitmentUnits');
            
            let html = '';
            units.forEach(unit => {
                html += `
                    <div class="recruitment-unit-row">
                        <div class="unit-info">
                            <span class="unit-name">${unit.name}</span>
                            <div class="unit-costs">
                                <span class="cost-item">
                                    <span class="cost-icon">üçñ</span>
                                    <span class="cost-value">${unit.food}</span>
                                </span>
                                <span class="cost-item">
                                    <span class="cost-icon">üí∞</span>
                                    <span class="cost-value">${unit.gold}</span>
                                </span>
                                <span class="cost-item">
                                    <span class="cost-icon">‚öíÔ∏è</span>
                                    <span class="cost-value">${unit.iron}</span>
                                </span>
                                <span class="cost-item">
                                    <span class="cost-icon">üì¶</span>
                                    <span class="cost-value">${unit.other}</span>
                                </span>
                            </div>
                        </div>
                        <div class="unit-controls">
                            <button class="unit-btn" onclick="decreaseUnit('${unit.name}')">-</button>
                            <span class="unit-quantity" id="quantity_${unit.name}">0</span>
                            <button class="unit-btn" onclick="increaseUnit('${unit.name}')">+</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function increaseUnit(unitName) {
            const quantityElement = document.getElementById(`quantity_${unitName}`);
            const currentQuantity = parseInt(quantityElement.textContent) || 0;
            quantityElement.textContent = currentQuantity + 1;
        }

        function decreaseUnit(unitName) {
            const quantityElement = document.getElementById(`quantity_${unitName}`);
            const currentQuantity = parseInt(quantityElement.textContent) || 0;
            if (currentQuantity > 0) {
                quantityElement.textContent = currentQuantity - 1;
            }
        }

        function clearAllInputs() {
            // Clear all terrain inputs
            const terrainInputs = [
                'plains', 'forest', 'hills', 'sea'
            ];
            
            // Clear all building inputs
            const buildingInputs = [
                'castle', 'outpost', 'harbor', 'bloodshrine', 'mine', 'fishery', 'breeding_den'
            ];
            
            [...terrainInputs, ...buildingInputs].forEach(id => {
                document.getElementById(id).value = '0';
            });
            
            // Hide results
            document.getElementById('results').style.display = 'none';
            
            showNotification('All inputs cleared!', 'info');
        }

        function calculateResources() {
            // Collect terrain data
            const terrainData = {
                plains: parseInt(document.getElementById('plains').value) || 0,
                forest: parseInt(document.getElementById('forest').value) || 0,
                hills: parseInt(document.getElementById('hills').value) || 0,
                sea: parseInt(document.getElementById('sea').value) || 0
            };
            
            // Collect building data
            const buildingData = {
                castle: parseInt(document.getElementById('castle').value) || 0,
                outpost: parseInt(document.getElementById('outpost').value) || 0,
                harbor: parseInt(document.getElementById('harbor').value) || 0,
                bloodshrine: parseInt(document.getElementById('bloodshrine').value) || 0,
                mine: parseInt(document.getElementById('mine').value) || 0,
                fishery: parseInt(document.getElementById('fishery').value) || 0,
                breeding_den: parseInt(document.getElementById('breeding_den').value) || 0
            };
            
            // Prepare data for server
            const requestData = {
                terrain: terrainData,
                buildings: buildingData
            };
            
            // Show loading state
            showNotification('Calculating resources...', 'info');
            
            // Send to server
            fetch('/calculate_resources', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(requestData)
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    displayResults(data.results);
                    showNotification('Resources calculated successfully!', 'success');
                } else {
                    showNotification('Error calculating resources: ' + data.error, 'error');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                showNotification('Error connecting to server', 'error');
            });
        }

        function sendToResourcePool() {
            const resultsDiv = document.getElementById('resourceResults');
            if (resultsDiv.innerHTML === '') {
                showNotification('Please calculate resources first!', 'error');
                return;
            }

            // Get current pool values
            const poolFood = parseInt(document.getElementById('poolFood').value) || 0;
            const poolGold = parseInt(document.getElementById('poolGold').value) || 0;
            const poolIron = parseInt(document.getElementById('poolIron').value) || 0;
            const poolOther = parseInt(document.getElementById('poolOther').value) || 0;

            // Get calculated results (this would normally come from the server response)
            // For now, we'll simulate this with the displayed results
            const foodResult = document.querySelector('.resource-item:nth-child(1) .resource-value')?.textContent || '0';
            const goldResult = document.querySelector('.resource-item:nth-child(2) .resource-value')?.textContent || '0';
            const ironResult = document.querySelector('.resource-item:nth-child(3) .resource-value')?.textContent || '0';

            // Add calculated resources to pool
            document.getElementById('poolFood').value = poolFood + parseInt(foodResult);
            document.getElementById('poolGold').value = poolGold + parseInt(goldResult);
            document.getElementById('poolIron').value = poolIron + parseInt(ironResult);
            // Note: Other resource calculation would be added here when implemented

            showNotification('Resources added to pool!', 'success');
        }

        function displayResults(results) {
            const resultsDiv = document.getElementById('resourceResults');
            const resultsSection = document.getElementById('results');
            
            // Create results HTML
            let html = '<div class="resources-grid">';
            
            if (results.food !== undefined) {
                html += `<div class="resource-item">
                    <span class="resource-label">Food:</span>
                    <span class="resource-value">${results.food}</span>
                </div>`;
            }
            
            if (results.gold !== undefined) {
                html += `<div class="resource-item">
                    <span class="resource-label">Gold:</span>
                    <span class="resource-value">${results.gold}</span>
                </div>`;
            }
            
            if (results.iron !== undefined) {
                html += `<div class="resource-item">
                    <span class="resource-label">Iron:</span>
                    <span class="resource-value">${results.iron}</span>
                </div>`;
            }
            
            html += '</div>';
            
            resultsDiv.innerHTML = html;
            resultsSection.style.display = 'block';
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize recruitment units on page load
        document.addEventListener('DOMContentLoaded', function() {
            updateRecruitmentUnits();
        });
    </script>

    <style>
        .resource-pool-section {
            max-width: 1200px;
            margin: 0 auto 30px auto;
        }

        .resource-pool-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .resource-pool-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            border-radius: 10px;
            border: 1px solid #444;
        }

        .resource-icon {
            font-size: 20px;
        }

        .resource-pool-item label {
            font-weight: bold;
            color: #ffd700;
            min-width: 60px;
        }

        .resource-pool-item input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #555;
            border-radius: 5px;
            background: #1a1a1a;
            color: white;
            font-size: 16px;
        }

        .recruitment-section {
            max-width: 1200px;
            margin: 30px auto;
        }

        .recruitment-grid {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
        }

        .recruitment-unit-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: linear-gradient(135deg, #2a2a2a 0%, #3a3a3a 100%);
            border-radius: 10px;
            border: 1px solid #444;
        }

        .unit-info {
            display: flex;
            flex-direction: column;
            gap: 10px;
            flex: 1;
        }

        .unit-name {
            font-weight: bold;
            color: #ffd700;
            font-size: 18px;
        }

        .unit-costs {
            display: flex;
            gap: 20px;
        }

        .cost-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .cost-icon {
            font-size: 16px;
        }

        .cost-value {
            font-weight: bold;
            color: white;
        }

        .unit-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .unit-btn {
            width: 30px;
            height: 30px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #444 0%, #666 100%);
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .unit-btn:hover {
            background: linear-gradient(135deg, #555 0%, #777 100%);
            transform: scale(1.1);
        }

        .unit-quantity {
            font-size: 18px;
            font-weight: bold;
            color: #ffd700;
            min-width: 30px;
            text-align: center;
        }

        @media (max-width: 768px) {
            .resource-pool-grid {
                grid-template-columns: 1fr;
            }

            .recruitment-unit-row {
                flex-direction: column;
                gap: 15px;
            }

            .unit-costs {
                flex-wrap: wrap;
                gap: 10px;
            }
        }
    </style>
</body>

</html> 